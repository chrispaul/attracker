<!DOCTYPE html>
<head>
  <style type="text/css">
    html, body { height: 100%; margin: 0; padding: 0; }
    #map { height: 60%; width: 50% }
    .wider{width: 50% }
    .narrower {width: 30% }
    .num { text-align: right; }
  </style>
</head>
<body>
    <h1>Hiker: {{ hiker.trail_name }} </h1>

    {% if error_message %}
        <p><strong>{{ error_message }}</strong></p>
    {% endif %}

    <table class=narrower>
        <tbody>
            <tr>
                <td>{{ hiker.miles_hiked }} miles hiked ({{ hiker.percent_hiked }}%)</td>
                <td>{{ hiker.miles_to_go }} miles remaining</td>
            </tr>
        </tbody>
    </table>
    <br>

    <div id="map"></div>
    <script type="text/javascript">
        var map;
        function initMap() {

            //Hack midpoint
            var latMid = 44.40039930901872;
            var lngMid = -71.1122943069697;
            map = new google.maps.Map(document.getElementById('map'), {
                center: {lat: latMid, lng: lngMid},
                zoom: 5,
                zoomControl: true,
                panControl: false
            });

            var polyline = JSON.parse('{{ polyline }}')
            var trail = new google.maps.Polyline({
                path: polyline.coordinates,
                    geodesic: true,
                    strokeColor: polyline.color, //'green', //'blue', //'yellow', //'#FF00FF',
                    strokeOpacity: 1.0,
                    strokeWeight: 4
                });
            trail.setMap(map);

            // Draw a point on the trail for the start of a day
            //TODO CP var latLng = {lat: 44.40016162702151, lng: -71.11198885103762};
            var latLng = {lat: 44.40016162702151, lng: -71.11198885103762};
            var marker = new google.maps.Marker({
                position: latLng,
                map: map,
                title: '9/8/2015 - 15 miles - Started at White Mountain Lodge & Hostel'
            });
        }
    </script>
    <script asynch defer
        src="https://maps.googleapis.com/maps/api/js?key={{google_maps_browser_key}}&callback=initMap">
    </script>

    <br>
    <div>
      <table class=wider>
        <tbody>
              <tr>
                  <td>Number of Segments: {{ hiker.number_segments }}</td>
                  <td><a href="{% url 'segment_add' hiker.id %}">Add Segment</a></td>
                  <td class=num><a href="{% url 'index' %}">Home to all Hikers</a></td>
              </tr>
        </tbody>
      </table>
    </div>
    <div id="table">
      <table border=1>
        <thead>
            <tr>
               <th>Date</th>
               <th>Start mile</th>
               <th>End mile</th>
               <th>Segment Distance</th>
               <th>Description</th>
               <th>Video</th>
               <th>Pictures</th>
               <th>Additional miles</th>
               <th>Delete segment</th>
               <th>Edit segment</th>
            </tr>
        </thead>
        <tbody>
            {% for segment in segments %}
              <tr>
                  <td>{{ segment.date }}</td>
                  <td class=num>{{ segment.start_mile }}</td>
                  <td class=num>{{ segment.end_mile }}</td>
                  <td class=num>{{ segment.distance }}</td>
                  <td>{{ segment.description }}</td>
                  <td>{{ segment.video_url }}</td>
                  <td>{{ segment.picture_url }}</td>
                  <td class=num>{{ segment.additional_miles }}</td>
                  <td><a href="{% url 'segment_delete' hiker.id segment.id %}">Delete Segment</a></td>
                  <td><a href="{% url 'segment_edit' hiker.id segment.id %}">Edit Segment</a></td>
              </tr>
            {% endfor %}
        </tbody>
      </table>
    </div>
    
</body>
